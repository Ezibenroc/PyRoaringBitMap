[tox]
envlist =
	cython_pre3
	cython3
	test_wheel


[testenv:cython_pre3]
deps =
	hypothesis
	cython<3.0.0
passenv =
	HYPOTHESIS_PROFILE
commands =
	python test.py
	python cydoctest.py


[testenv:cython3]
deps =
	hypothesis
	cython>=3.0.2
passenv =
	HYPOTHESIS_PROFILE
commands =
	python test.py
	python cydoctest.py


[testenv:test_wheel]
deps =
	hypothesis
	wheel
	twine
skip_sdist = true
skip_install = true
passenv =
	HYPOTHESIS_PROFILE
allowlist_externals =
	rm
	mkdir
commands =
	# Clear our prebuilt wheels so we have a fresh directory
    - mkdir wheel
    - rm wheel/*
    # Build the wheel into the cleaned directory
	pip wheel . -w wheel
	# Install from the wheel in that directory
	pip install --only-binary ":all:" --find-links=wheel --no-index pyroaring
	python test.py
	python cydoctest.py


